name: Analyze network indicators and reputation
id: 710b1249-88b4-4dfd-95cc-541cc688e1a3
tags:
  analytics_story:
    - Response Plan
  nist:
    - RS.RP
description: |
  Validate indicator existance, reputation, detonation and determine if Known APT, Commodity, Suspicous or Not Malicious?

  1. If Splunk present, run Splunk Query on each indictor and prevalence in the environment. Summarize number of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)
    a. search -> ```| stats ...```
  2. Gather repetitional, intelligence and general information regarding indicator into a note (a note for each indicator)
  3. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.
  4. Make a determination of indicator, Known APT, Commodity, Suspicious or Not Malicious and whether to tag to block indicator
    a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicious = Low, Not Malicious = Info)
    b. Change container and artifact severity and tag artifact & indicator(s) with blocked and determination tag
automation:
  role:
  sla_type: minutes
  sla:
  is_note_required: false
  actions:
    - run query
    - whois ip
    - whois domain
    - geolocate ip
    - ip reputation
    - domain reputation
    - url reputation
    - ip intelligence
    - domain intelligence
    - url intelligence
    - hunt ip
    - hunt domain
    - hunt url
    - detonate url
  playbooks:
    - scm:
      playook: ""
references:
    - 3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf
how_to_implement:
date: '2020-07-30'
version: 1
author: ButterCup, Splunk
